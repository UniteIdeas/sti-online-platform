{% extends 'base.html' %}
{% load static %}
{% block style %}
<style>
    .filter {
        background: linear-gradient(90deg,#D2FFEF,#C6E3FF);
    }
    .recommended-content-type {
        font-weight: bold;
        margin-bottom: -20px;
        margin-top: 40px;
    }
    .result {
        margin:40px auto;
    }
    .result-title {
        font-weight: bold;
        color: #327abe;
    }
    .result-attribution {
        color: #327abe;
    }
    .partner-logo {
        max-height: 16px;
        float: left;
        margin-right: 16px;
    }
    .language-menu input {
        margin-left: 2px;
    }
    .language-menu label {
        font-weight: 300;
        padding-left: 5px;
    }
    .filter-search {
        margin-top: 16px;
        margin-bottom: 16px;
    }
    .left-bar .filter-detail {
        margin-bottom: 32px;
    }
    .filter-detail label {
        font-weight: 300;
    }
    .filter-detail div {
        font-weight: bold;
    }
    .filter-detail .row {
        margin-top: 5px;
        margin-bottom: 5px;
    }
    #searchButtonOutline {
        border: 1px solid #327abe;
        border-radius: 3px;
        margin-top: 3px;
    }
    .recommended-type-all {
        margin-top: -20px;
        margin-bottom: 20px;
    }
    .recommended-type-all a {
        text-decoration: underline;
    }
    .footer {
        box-shadow: 0 -1px 13px #DADADA;
    }
</style>
{% endblock style %}
{% block content %}
<form id="search" action="/search/" data-currentpage={{ filters.page }}>
<div class="filter">
    <div class="container-fluid">
        <input type="hidden" name="types" />
        <input type="hidden" name="partners" />
        <input type="hidden" name="language" />
        <div class="col-xs-8 col-xs-offset-2 filter-search">
            <div class="input-group">
                <span class="input-group-addon" style="background-color:inherit; border:none; padding:0; padding-right:12px;">
                    <img width="27px" height="27px" src="{% static '/images/TFM_logo.png' %}" />
                </span>
                <input name="query" class="form-control" type="text" value="{{ filters.query }}"/>
                <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">Search</button>
                </span>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="left-bar col-xs-2">
        <div class="filter-detail">
            <div class="row">Types</div>
            <div class="row">
                <input class="filter-type" type="checkbox" id="publications" {% if filters.types == None or filters.types == 'all' or filters.types.publications == True %}checked{% endif %}/>
                <label for="publications">Publications</label>
            </div>
            <div class="row">
                <input class="filter-type" type="checkbox" id="technologyoffers" {% if filters.types == None or filters.types == 'all' or filters.types.technologyoffers == True %}checked{% endif %}/>
                <label for="technologyoffers">Technology Offers</label>
            </div>
            <div class="row">
                <input class="filter-type" type="checkbox" id="technologyrequests" {% if filters.types == None or filters.types == 'all' or filters.types.technologyrequests == True %}checked{% endif %}/>
                <label for="technologyrequests">Technology Requests</label>
            </div>
            <div class="row">
                <input class="filter-type" type="checkbox" id="businessoffers" {% if filters.types == None or filters.types == 'all' or filters.types.businessoffers == True %}checked{% endif %}/>
                <label for="businessoffers">Business Offers</label>
            </div>
            <div class="row">
                <input class="filter-type" type="checkbox" id="businessrequests" {% if filters.types == None or filters.types == 'all' or filters.types.businessrequests == True %}checked{% endif %}/>
                <label for="businessrequests">Business Requests</label>
            </div>
        </div>
        <div class="filter-detail">
            <div class="row">Sources</div>
            <div class="row">
                <input class="filter-partner" type="checkbox" id="apctt" {% if filters.partners == None or filters.partners == 'all' or filters.partners.apctt == True %}checked{% endif %}/>
                <label for="apctt"><img class="partner-logo" src="{% static 'images/apctt-logo.png' %}" /></label>
            </div>
            <div class="row">
                <input class="filter-partner" type="checkbox" id="cittc" {% if filters.partners == None or filters.partners == 'all' or filters.partners.cittc == True %}checked{% endif %}/>
                <label for="cittc"><img class="partner-logo" src="{% static 'images/cittc-logo.png' %}" /></label>
            </div>
            <div class="row">
                <input class="filter-partner" type="checkbox" id="unido" {% if filters.partners == None or filters.partners == 'all' or filters.partners.unido == True %}checked{% endif %}/>
                <label for="unido"><img class="partner-logo" src="{% static 'images/unido-logo.png' %}" /></label>
            </div>
            <div class="row">
                <input class="filter-partner" type="checkbox" id="wipogreen" {% if filters.partners == None or filters.partners == 'all' or filters.partners.wipogreen == True %}checked{% endif %}/>
                <label for="wipogreen"><img class="partner-logo" src="{% static 'images/wipo-green-logo.png' %}" /></label>
            </div>
            <div class="row">
                <input class="filter-partner" type="checkbox" id="een" {% if filters.partners == None or filters.partners == 'all' or filters.partners.een == True %}checked{% endif %}/>
                <label for="een"><img class="partner-logo" src="{% static 'images/een-logo.png' %}" /></label>
            </div>
            <div class="row">
                <input class="filter-partner" type="checkbox" id="unfccc" {% if filters.partners == None or filters.partners == 'all' or filters.partners.unfccc == True %}checked{% endif %}/>
                <label for="unfccc"><img class="partner-logo" src="{% static 'images/unfccc-logo.png' %}" /></label>
            </div>
            <div class="row">
                <input class="filter-partner" type="checkbox" id="unossc" {% if filters.partners == None or filters.partners == 'all' or filters.partners.unossc == True %}checked{% endif %}/>
                <label for="unossc"><img class="partner-logo" src="{% static 'images/unossc-logo.png' %}" /></label>
            </div>
            <div class="row">
                <input class="filter-partner" type="checkbox" id="openaire" {% if filters.partners == None or filters.partners == 'all' or filters.partners.openaire == True %}checked{% endif %}/>
                <label for="openaire"><img class="partner-logo" src="{% static 'images/openaire-logo.png' %}" /></label>
            </div>
        </div>
        <div class="filter-detail">
            <div>Language</div>
            <div class="row">
                <input type="radio" name="filter-language" id="all" {% if filters.language == None or filters.language == 'all' %}checked{% endif %}/><label for="all">Any language</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="english" {% if filters.language == 'english' %}checked{% endif %}/><label for="english">English</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="french" {% if filters.language == 'french' %}checked{% endif %}/><label for="french">French</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="german" {% if filters.language == 'german' %}checked{% endif %}/><label for="german">German</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="spanish" {% if filters.language == 'spanish' %}checked{% endif %}/><label for="spanish">Spanish</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="russian" {% if filters.language == 'russian' %}checked{% endif %}/><label for="russian">Russian</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="danish" {% if filters.language == 'danish' %}checked{% endif %}/><label for="danish">Danish</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="dutch" {% if filters.language == 'dutch' %}checked{% endif %}/><label for="dutch">Dutch</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="finnish" {% if filters.language == 'finnish' %}checked{% endif %}/><label for="finnish">Finnish</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="hungarian" {% if filters.language == 'hungarian' %}checked{% endif %}/><label for="hungarian">Hungarian</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="italian" {% if filters.language == 'italian' %}checked{% endif %}/><label for="italian">Italian</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="norwegian" {% if filters.language == 'norwegian' %}checked{% endif %}/><label for="norwegian">Norwegian</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="portuguese" {% if filters.language == 'portuguese' %}checked{% endif %}/><label for="portuguese">Portuguese</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="romanian" {% if filters.language == 'romanian' %}checked{% endif %}/><label for="romanian">Romanian</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="swedish" {% if filters.language == 'swedish' %}checked{% endif %}/><label for="swedish">Swedish</label>
            </div>
            <div class="row">
                <input type="radio" name="filter-language" id="turkish" {% if filters.language == 'turkish' %}checked{% endif %}/><label for="turkish">Turkish</label>
            </div>
        </div>
        <div class="filter-detail">
            <div class="row">Location</div>
            <div class="row">
                <div class="input-group">
                    <input type="text" name="location"{% if filters.location != 'all' %} value="{{filters.location}}"{% endif %} class="form-control"/>
                    <div class="input-group-btn">
                        <button type="submit" class="btn btn-info">Go</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="results col-xs-8">
            <div class="col-xs-12">
            {% for row in results %}
                {% include "sti/search-result.html" with row=row %}
            {% endfor %}
            {% if results|length == 0 %}
                <div style="padding:53px 0; font-weight:bold;">
                No results found
                </div>
            {% endif %}
            {% if prev or next %}
            <nav>
                <ul class="pager">
                    {% if prev %}
                    <li class="previous"><a href="{{ prev }}" data-nav="prev">&larr; Previous</a></li>
                    {% endif %}{%if next %}
                    <li class="next"><a href="{{ next }}" data-nav="next">Next &rarr;</a></li>
                    {%endif%}
                </ul>
            </nav>
            {% endif %}
            </div>
    </div>
</div>
</form>
<script>
$('#search').on('submit', function(event) {
    var query = $('#filter-query').val();
    var partners = {};
    var allPartners = true;
    var types = {};
    var allTypes = true;
    var partnerSelections = $('.filter-partner');
    for (var i=0; i<partnerSelections.length; i++) {
        if (partnerSelections[i].checked) {
            partners[partnerSelections[i].id] = true;
        }
        else {
            allPartners = false;
        }
    }
    if (!allPartners) {
        $('[name="partners"]').val(JSON.stringify(partners));
    }
    var typeSelections = $('.filter-type');
    for (var i=0; i<typeSelections.length; i++) {
        if (typeSelections[i].checked) {
            types[typeSelections[i].id] = true;
        }
        else {
            allTypes = false;
        }
    }
    if (!allTypes) {
        $('[name="types"]').val(JSON.stringify(types));
    }
    if ($('[name="filter-language"]:checked')[0].id !== 'all') {
        $('[name="language"]').val($('[name="filter-language"]:checked')[0].id);
    }
});
</script>
{% endblock content %}
